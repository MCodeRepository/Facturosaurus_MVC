@using Facturosaurus.Application.CompanyDetails
@using Facturosaurus.Application.CompanyDetails.Commands.CreateNewCompanyDetails
@model IEnumerable<CompanyDetailsDto>

@{
    ViewData["Title"] = "Dane firmy";
}

<h1 class="titeOfPages">Historia zmian danych firmy:</h1>

<table class="table table-striped table-hover">
    <thead>
        <tr>
            <th>
                Data aktualizacji
            </th>
            <th>
                Nazwa firmy
            </th>
            <th>
                NIP
            </th>
            <th>
                Adres siedziby
            </th>
            <th>
                Konto bankowe
            </th>
            <th>
                Kontakt
            </th>
            <th></th>
        </tr>
    </thead>
    <tbody>
@foreach (var item in Model) {
            var updateDate = item.UpdateDate.ToString("yyyy-MM-dd");
            var fullAddress = item.GetFullAddress();
            <tr>
                <td>
                        <b>@Html.DisplayFor(modelItem => updateDate)</b>
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.CompanyName) <br />
                    @Html.DisplayFor(modelItem => item.ShortCompanyName) 
                    
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.NipNumber)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => fullAddress)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.BankName) <br />
                    @Html.DisplayFor(modelItem => item.Currency) @Html.DisplayFor(modelItem => item.BankAccountNumber)
                </td>             
                <td>
                    @Html.DisplayFor(modelItem => item.PhoneNumber) <br />
                    @Html.DisplayFor(modelItem => item.AddressEmail)
                </td>
            </tr>
             }
        </tbody>
    </table>

@{
    var lastCompanyDetails = Model.LastOrDefault();
    var loadCompanyDetails = lastCompanyDetails != null ? lastCompanyDetails.GetCreateNewCompanyDetailsCommand() : new CreateNewCompanyDetailsCommand();
}

<div class="m3">
    <partial name="_CreateNewCompanyDetails" model="@loadCompanyDetails" />
</div>


@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
}